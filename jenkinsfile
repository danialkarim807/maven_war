pipeline {
    agent any
    stages {
        stage('Build Application') {
            steps {
                sh 'mvn -f pom.xml clean package'
            }
            post {
                success {
                    echo "Now archiving the artifacts..."
                    archiveArtifacts artifacts: '**/*.war'       
                }
            }
        }

        stage('Create Tomcat Docker Image') {
            steps {
                withCredentials([usernamePassword(credentialsId: 'BUILD_ID', passwordVariable: 'meather@601', usernameVariable: 'danialkarim8@gmail.com')]) {
                sh "echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin"
                sh 'docker build . -t tomcatesamplewebapp'
                
            }
        }

        // Uncomment and modify these stages as needed
        /*
        stage('Deploy in Staging Environment') {
            steps {
                build job: 'Deploy_application_staging_env'
            }
        }

        stage('Deploy to Production Environment') {
            steps {
                script {
                    timeout(time: 5, unit: 'DAYS') {
                        input message: 'Approve PRODUCTION Deployment?'
                    }
                }
                build job: 'Deploy_Application_staging_env_to_production'
            }
        }
        */
    }
}


